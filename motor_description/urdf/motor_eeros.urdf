<?xml version="1.0"?>
<robot name="motor">
	
	<link name="world"/>

	<joint name="fixe_base" type="fixed">
		<parent link="world"/>
		<child link="base_link"/>
		<origin xyz="0 0 0.005"/>
	</joint>

	<link name="base_link">
		<visual>
			<geometry>
				<box size="0.1 0.1 0.01"/>
				<origin xyz="0 0 0.01"/>
			</geometry>
		</visual>
		<collision>
			<geometry>
				<box size="0.1 0.1 0.01"/>
        <origin xyz="0 0 0.01"/>
			</geometry>
		</collision>
    <inertial>
      <mass value="1"/>
      <inertia ixx="1" ixy="0.0" ixz="0.0" iyy="1" iyz="0.0" izz="1"/>
    </inertial>
	</link>

	<joint name="motor_axis" type="continuous">
    <parent link="base_link"/>
    <child link="rotor"/>
    <axis xyz="0 0 1"/>
    <origin xyz="0 0 0.1" rpy="0 1.570796327 0"/>
		<dynamics damping="2.1087e-4"/>
  </joint>

  <link name="rotor">
    <visual>
      <geometry>
        <cylinder length="0.055" radius="0.009"/>
      </geometry>
      <origin xyz="0 0 0" rpy="0 0 0"/>
    </visual>
    <collision>
      <geometry>
        <cylinder length="0.055" radius="0.009"/>
      </geometry>
      <origin xyz="0 0 0" rpy="0 0 0"/>
    </collision>
    <inertial>
      <mass value="0.13"/>
      <inertia ixx="0.000018761" ixy="0.0" ixz="0.0" iyy="0.000018761" iyz="0.0" izz="0.00000279"/>
    </inertial>
	</link>

	<joint name="coupling" type="fixed">
		<parent link="rotor"/>
		<child link="flywheel"/>
		<origin xyz="0 0 0.1"/>
	</joint>

	<link name="flywheel">
		<visual>
			<geometry>
				<cylinder length="0.006" radius="0.048"/>
			</geometry>
			<origin xyz="0 0 0" rpy="0 0 0"/>
		</visual>
		<collision>
      <geometry>
        <cylinder length="0.006" radius="0.048"/>
      </geometry>
			<origin xyz="0 0 0" rpy="0 0 0"/>
		</collision>
		<inertial>
      <mass value="0.37"/>
      <inertia ixx="0.00021423" ixy="0.0" ixz="0.0" iyy="0.00021423" iyz="0.0" izz="0.00042624"/>
    </inertial>
	</link>

	<gazebo>
		<plugin name="joint_force" filename="libgazebo_ros_joint_force.so">
			<robotNamespace>/motor_sim</robotNamespace>
			<topicName>effort</topicName>
			<jointName>motor_axis</jointName>
		</plugin>
	</gazebo>

	<gazebo>
		<plugin name="joint_state_publisher" filename="libgazebo_ros_joint_state_publisher.so">
			<robotNamespace>/motor_sim</robotNamespace>
			<jointName>motor_axis</jointName>
			<updateRate>10000.0</updateRate> <!-- to get sure that one every sim step called, up to 10k -->
		</plugin>
	</gazebo>

</robot>
